[
    {
        "id": "tab_shelters",
        "type": "tab",
        "label": "Shelters API",
        "disabled": false,
        "info": "API REST para gesti贸n de albergues"
    },
    {
        "id": "tab_refugees",
        "type": "tab",
        "label": "Refugees API",
        "disabled": false,
        "info": "API REST para gesti贸n de refugiados"
    },
    {
        "id": "tab_families",
        "type": "tab",
        "label": "Families API",
        "disabled": false,
        "info": "API REST para gesti贸n de familias"
    },
    {
        "id": "tab_assignments",
        "type": "tab",
        "label": "Assignments API",
        "disabled": false,
        "info": "API REST para gesti贸n de asignaciones"
    },
    {
        "id": "301245f94e1239d9",
        "type": "postgreSQLConfig",
        "name": "ShelterAI DB",
        "host": "postgres",
        "hostFieldType": "str",
        "port": 5432,
        "portFieldType": "num",
        "database": "shelterai",
        "databaseFieldType": "str",
        "ssl": "false",
        "sslFieldType": "bool",
        "applicationName": "",
        "applicationNameType": "str",
        "max": 10,
        "maxFieldType": "num",
        "idle": 1000,
        "idleFieldType": "num",
        "connectionTimeout": 10000,
        "connectionTimeoutFieldType": "num",
        "user": "root",
        "userFieldType": "str",
        "password": "root",
        "passwordFieldType": "str"
    },
    {
        "id": "shelter_get_all",
        "type": "http in",
        "z": "tab_shelters",
        "name": "GET /api/shelters",
        "url": "/api/shelters",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 80,
        "wires": [
            [
                "shelter_get_all_query"
            ]
        ]
    },
    {
        "id": "shelter_get_all_query",
        "type": "postgresql",
        "z": "tab_shelters",
        "name": "Query All Shelters",
        "query": "SELECT * FROM shelters ORDER BY id",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 370,
        "y": 80,
        "wires": [
            [
                "shelter_response"
            ]
        ]
    },
    {
        "id": "shelter_get_by_id",
        "type": "http in",
        "z": "tab_shelters",
        "name": "GET /api/shelters/:id",
        "url": "/api/shelters/:id",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 140,
        "wires": [
            [
                "shelter_get_by_id_prepare"
            ]
        ]
    },
    {
        "id": "shelter_get_by_id_prepare",
        "type": "function",
        "z": "tab_shelters",
        "name": "Prepare Query",
        "func": "msg.queryParameters = [parseInt(msg.req.params.id)];\nmsg.payload = \"SELECT * FROM shelters WHERE id = $1\";\nreturn msg;",
        "outputs": 1,
        "x": 380,
        "y": 140,
        "wires": [
            [
                "shelter_get_by_id_query"
            ]
        ]
    },
    {
        "id": "shelter_get_by_id_query",
        "type": "postgresql",
        "z": "tab_shelters",
        "name": "Query Shelter",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 580,
        "y": 140,
        "wires": [
            [
                "shelter_single_response"
            ]
        ]
    },
    {
        "id": "shelter_get_available",
        "type": "http in",
        "z": "tab_shelters",
        "name": "GET /api/shelters/available",
        "url": "/api/shelters/available",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 170,
        "y": 200,
        "wires": [
            [
                "shelter_get_available_query"
            ]
        ]
    },
    {
        "id": "shelter_get_available_query",
        "type": "postgresql",
        "z": "tab_shelters",
        "name": "Query Available",
        "query": "SELECT * FROM shelters WHERE current_occupancy < max_capacity ORDER BY id",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 410,
        "y": 200,
        "wires": [
            [
                "shelter_response"
            ]
        ]
    },
    {
        "id": "shelter_post",
        "type": "http in",
        "z": "tab_shelters",
        "name": "POST /api/shelters",
        "url": "/api/shelters",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 260,
        "wires": [
            [
                "shelter_post_prepare"
            ]
        ]
    },
    {
        "id": "shelter_post_prepare",
        "type": "function",
        "z": "tab_shelters",
        "name": "Prepare Insert",
        "func": "const data = msg.payload;\nmsg.queryParameters = [\n    data.name, data.address, data.phone_number, data.email,\n    data.max_capacity, data.current_occupancy || 0,\n    data.has_medical_facilities || false, data.has_childcare || false,\n    data.has_disability_access || false, data.languages_spoken,\n    data.latitude, data.longitude, data.shelter_type, data.services_offered\n];\nmsg.payload = `INSERT INTO shelters (name, address, phone_number, email, max_capacity, current_occupancy, has_medical_facilities, has_childcare, has_disability_access, languages_spoken, latitude, longitude, shelter_type, services_offered, created_at, updated_at) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) RETURNING *`;\nreturn msg;",
        "outputs": 1,
        "x": 370,
        "y": 260,
        "wires": [
            [
                "shelter_post_query"
            ]
        ]
    },
    {
        "id": "shelter_post_query",
        "type": "postgresql",
        "z": "tab_shelters",
        "name": "Insert Shelter",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 570,
        "y": 260,
        "wires": [
            [
                "shelter_created_response"
            ]
        ]
    },
    {
        "id": "shelter_put",
        "type": "http in",
        "z": "tab_shelters",
        "name": "PUT /api/shelters/:id",
        "url": "/api/shelters/:id",
        "method": "put",
        "upload": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 320,
        "wires": [
            [
                "shelter_put_prepare"
            ]
        ]
    },
    {
        "id": "shelter_put_prepare",
        "type": "function",
        "z": "tab_shelters",
        "name": "Prepare Update",
        "func": "const data = msg.payload;\nconst id = parseInt(msg.req.params.id);\nmsg.queryParameters = [\n    data.name, data.address, data.phone_number, data.email,\n    data.max_capacity, data.current_occupancy,\n    data.has_medical_facilities, data.has_childcare,\n    data.has_disability_access, data.languages_spoken,\n    data.latitude, data.longitude, data.shelter_type, data.services_offered, id\n];\nmsg.payload = `UPDATE shelters SET name=$1, address=$2, phone_number=$3, email=$4, max_capacity=$5, current_occupancy=$6, has_medical_facilities=$7, has_childcare=$8, has_disability_access=$9, languages_spoken=$10, latitude=$11, longitude=$12, shelter_type=$13, services_offered=$14, updated_at=CURRENT_TIMESTAMP WHERE id=$15 RETURNING *`;\nreturn msg;",
        "outputs": 1,
        "x": 370,
        "y": 320,
        "wires": [
            [
                "shelter_put_query"
            ]
        ]
    },
    {
        "id": "shelter_put_query",
        "type": "postgresql",
        "z": "tab_shelters",
        "name": "Update Shelter",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 580,
        "y": 320,
        "wires": [
            [
                "shelter_single_response"
            ]
        ]
    },
    {
        "id": "shelter_delete",
        "type": "http in",
        "z": "tab_shelters",
        "name": "DELETE /api/shelters/:id",
        "url": "/api/shelters/:id",
        "method": "delete",
        "upload": false,
        "swaggerDoc": "",
        "x": 160,
        "y": 380,
        "wires": [
            [
                "shelter_delete_prepare"
            ]
        ]
    },
    {
        "id": "shelter_delete_prepare",
        "type": "function",
        "z": "tab_shelters",
        "name": "Prepare Delete",
        "func": "msg.queryParameters = [parseInt(msg.req.params.id)];\nmsg.payload = \"DELETE FROM shelters WHERE id = $1\";\nreturn msg;",
        "outputs": 1,
        "x": 380,
        "y": 380,
        "wires": [
            [
                "shelter_delete_query"
            ]
        ]
    },
    {
        "id": "shelter_delete_query",
        "type": "postgresql",
        "z": "tab_shelters",
        "name": "Delete Shelter",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 580,
        "y": 380,
        "wires": [
            [
                "shelter_delete_response"
            ]
        ]
    },
    {
        "id": "shelter_response",
        "type": "function",
        "z": "tab_shelters",
        "name": "Format Response",
        "func": "msg.statusCode = 200;\nmsg.payload = msg.payload || [];\nreturn msg;",
        "outputs": 1,
        "x": 790,
        "y": 80,
        "wires": [
            [
                "shelter_http_response"
            ]
        ]
    },
    {
        "id": "shelter_single_response",
        "type": "function",
        "z": "tab_shelters",
        "name": "Format Single",
        "func": "if (msg.payload && msg.payload.length > 0) {\n    msg.statusCode = 200;\n    msg.payload = msg.payload[0];\n} else {\n    msg.statusCode = 404;\n    msg.payload = { error: \"Shelter not found\" };\n}\nreturn msg;",
        "outputs": 1,
        "x": 780,
        "y": 140,
        "wires": [
            [
                "shelter_http_response"
            ]
        ]
    },
    {
        "id": "shelter_created_response",
        "type": "function",
        "z": "tab_shelters",
        "name": "Format Created",
        "func": "msg.statusCode = 201;\nmsg.payload = msg.payload[0];\nreturn msg;",
        "outputs": 1,
        "x": 790,
        "y": 260,
        "wires": [
            [
                "shelter_http_response"
            ]
        ]
    },
    {
        "id": "shelter_delete_response",
        "type": "function",
        "z": "tab_shelters",
        "name": "Format Delete",
        "func": "msg.statusCode = 204;\nmsg.payload = \"\";\nreturn msg;",
        "outputs": 1,
        "x": 780,
        "y": 380,
        "wires": [
            [
                "shelter_http_response"
            ]
        ]
    },
    {
        "id": "shelter_http_response",
        "type": "http response",
        "z": "tab_shelters",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1000,
        "y": 220,
        "wires": []
    },
    {
        "id": "refugee_get_all",
        "type": "http in",
        "z": "tab_refugees",
        "name": "GET /api/refugees",
        "url": "/api/refugees",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 80,
        "wires": [
            [
                "refugee_get_all_query"
            ]
        ]
    },
    {
        "id": "refugee_get_all_query",
        "type": "postgresql",
        "z": "tab_refugees",
        "name": "Query All Refugees",
        "query": "SELECT * FROM refugees ORDER BY id",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 370,
        "y": 80,
        "wires": [
            [
                "refugee_response"
            ]
        ]
    },
    {
        "id": "refugee_get_by_id",
        "type": "http in",
        "z": "tab_refugees",
        "name": "GET /api/refugees/:id",
        "url": "/api/refugees/:id",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 140,
        "wires": [
            [
                "refugee_get_by_id_prepare"
            ]
        ]
    },
    {
        "id": "refugee_get_by_id_prepare",
        "type": "function",
        "z": "tab_refugees",
        "name": "Prepare Query",
        "func": "msg.queryParameters = [parseInt(msg.req.params.id)];\nmsg.payload = \"SELECT * FROM refugees WHERE id = $1\";\nreturn msg;",
        "outputs": 1,
        "x": 380,
        "y": 140,
        "wires": [
            [
                "refugee_get_by_id_query"
            ]
        ]
    },
    {
        "id": "refugee_get_by_id_query",
        "type": "postgresql",
        "z": "tab_refugees",
        "name": "Query Refugee",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 580,
        "y": 140,
        "wires": [
            [
                "refugee_single_response"
            ]
        ]
    },
    {
        "id": "refugee_get_by_family",
        "type": "http in",
        "z": "tab_refugees",
        "name": "GET /api/refugees/family/:familyId",
        "url": "/api/refugees/family/:familyId",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 180,
        "y": 200,
        "wires": [
            [
                "refugee_get_by_family_prepare"
            ]
        ]
    },
    {
        "id": "refugee_get_by_family_prepare",
        "type": "function",
        "z": "tab_refugees",
        "name": "Prepare Query",
        "func": "msg.queryParameters = [parseInt(msg.req.params.familyId)];\nmsg.payload = \"SELECT * FROM refugees WHERE family_id = $1 ORDER BY id\";\nreturn msg;",
        "outputs": 1,
        "x": 430,
        "y": 200,
        "wires": [
            [
                "refugee_get_by_family_query"
            ]
        ]
    },
    {
        "id": "refugee_get_by_family_query",
        "type": "postgresql",
        "z": "tab_refugees",
        "name": "Query",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 630,
        "y": 200,
        "wires": [
            [
                "refugee_response"
            ]
        ]
    },
    {
        "id": "refugee_get_high_vulnerability",
        "type": "http in",
        "z": "tab_refugees",
        "name": "GET /api/refugees/high-vulnerability",
        "url": "/api/refugees/high-vulnerability",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 190,
        "y": 260,
        "wires": [
            [
                "refugee_get_high_vuln_prepare"
            ]
        ]
    },
    {
        "id": "refugee_get_high_vuln_prepare",
        "type": "function",
        "z": "tab_refugees",
        "name": "Prepare Query",
        "func": "const minScore = parseFloat(msg.req.query.minScore) || 7.0;\nmsg.queryParameters = [minScore];\nmsg.payload = \"SELECT * FROM refugees WHERE vulnerability_score >= $1 ORDER BY vulnerability_score DESC\";\nreturn msg;",
        "outputs": 1,
        "x": 450,
        "y": 260,
        "wires": [
            [
                "refugee_get_high_vuln_query"
            ]
        ]
    },
    {
        "id": "refugee_get_high_vuln_query",
        "type": "postgresql",
        "z": "tab_refugees",
        "name": "Query",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 650,
        "y": 260,
        "wires": [
            [
                "refugee_response"
            ]
        ]
    },
    {
        "id": "refugee_post",
        "type": "http in",
        "z": "tab_refugees",
        "name": "POST /api/refugees",
        "url": "/api/refugees",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 320,
        "wires": [
            [
                "refugee_post_prepare"
            ]
        ]
    },
    {
        "id": "refugee_post_prepare",
        "type": "function",
        "z": "tab_refugees",
        "name": "Prepare Insert",
        "func": "const data = msg.payload;\nmsg.queryParameters = [\n    data.first_name, data.last_name, data.age, data.gender,\n    data.nationality, data.languages_spoken, data.phone_number,\n    data.email, data.family_id, data.medical_conditions,\n    data.special_needs, data.vulnerability_score || 0,\n    data.education_level, data.employment_status, data.registration_date\n];\nmsg.payload = `INSERT INTO refugees (first_name, last_name, age, gender, nationality, languages_spoken, phone_number, email, family_id, medical_conditions, special_needs, vulnerability_score, education_level, employment_status, registration_date, created_at, updated_at) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) RETURNING *`;\nreturn msg;",
        "outputs": 1,
        "x": 370,
        "y": 320,
        "wires": [
            [
                "refugee_post_query"
            ]
        ]
    },
    {
        "id": "refugee_post_query",
        "type": "postgresql",
        "z": "tab_refugees",
        "name": "Insert Refugee",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 570,
        "y": 320,
        "wires": [
            [
                "refugee_created_response"
            ]
        ]
    },
    {
        "id": "refugee_put",
        "type": "http in",
        "z": "tab_refugees",
        "name": "PUT /api/refugees/:id",
        "url": "/api/refugees/:id",
        "method": "put",
        "upload": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 380,
        "wires": [
            [
                "refugee_put_prepare"
            ]
        ]
    },
    {
        "id": "refugee_put_prepare",
        "type": "function",
        "z": "tab_refugees",
        "name": "Prepare Update",
        "func": "const data = msg.payload;\nconst id = parseInt(msg.req.params.id);\nmsg.queryParameters = [\n    data.first_name, data.last_name, data.age, data.gender,\n    data.nationality, data.languages_spoken, data.phone_number,\n    data.email, data.family_id, data.medical_conditions,\n    data.special_needs, data.vulnerability_score,\n    data.education_level, data.employment_status, data.registration_date, id\n];\nmsg.payload = `UPDATE refugees SET first_name=$1, last_name=$2, age=$3, gender=$4, nationality=$5, languages_spoken=$6, phone_number=$7, email=$8, family_id=$9, medical_conditions=$10, special_needs=$11, vulnerability_score=$12, education_level=$13, employment_status=$14, registration_date=$15, updated_at=CURRENT_TIMESTAMP WHERE id=$16 RETURNING *`;\nreturn msg;",
        "outputs": 1,
        "x": 370,
        "y": 380,
        "wires": [
            [
                "refugee_put_query"
            ]
        ]
    },
    {
        "id": "refugee_put_query",
        "type": "postgresql",
        "z": "tab_refugees",
        "name": "Update Refugee",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 580,
        "y": 380,
        "wires": [
            [
                "refugee_single_response"
            ]
        ]
    },
    {
        "id": "refugee_delete",
        "type": "http in",
        "z": "tab_refugees",
        "name": "DELETE /api/refugees/:id",
        "url": "/api/refugees/:id",
        "method": "delete",
        "upload": false,
        "swaggerDoc": "",
        "x": 160,
        "y": 440,
        "wires": [
            [
                "refugee_delete_prepare"
            ]
        ]
    },
    {
        "id": "refugee_delete_prepare",
        "type": "function",
        "z": "tab_refugees",
        "name": "Prepare Delete",
        "func": "msg.queryParameters = [parseInt(msg.req.params.id)];\nmsg.payload = \"DELETE FROM refugees WHERE id = $1\";\nreturn msg;",
        "outputs": 1,
        "x": 380,
        "y": 440,
        "wires": [
            [
                "refugee_delete_query"
            ]
        ]
    },
    {
        "id": "refugee_delete_query",
        "type": "postgresql",
        "z": "tab_refugees",
        "name": "Delete Refugee",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 580,
        "y": 440,
        "wires": [
            [
                "refugee_delete_response"
            ]
        ]
    },
    {
        "id": "refugee_response",
        "type": "function",
        "z": "tab_refugees",
        "name": "Format Response",
        "func": "msg.statusCode = 200;\nmsg.payload = msg.payload || [];\nreturn msg;",
        "outputs": 1,
        "x": 790,
        "y": 80,
        "wires": [
            [
                "refugee_http_response"
            ]
        ]
    },
    {
        "id": "refugee_single_response",
        "type": "function",
        "z": "tab_refugees",
        "name": "Format Single",
        "func": "if (msg.payload && msg.payload.length > 0) {\n    msg.statusCode = 200;\n    msg.payload = msg.payload[0];\n} else {\n    msg.statusCode = 404;\n    msg.payload = { error: \"Refugee not found\" };\n}\nreturn msg;",
        "outputs": 1,
        "x": 780,
        "y": 140,
        "wires": [
            [
                "refugee_http_response"
            ]
        ]
    },
    {
        "id": "refugee_created_response",
        "type": "function",
        "z": "tab_refugees",
        "name": "Format Created",
        "func": "msg.statusCode = 201;\nmsg.payload = msg.payload[0];\nreturn msg;",
        "outputs": 1,
        "x": 790,
        "y": 320,
        "wires": [
            [
                "refugee_http_response"
            ]
        ]
    },
    {
        "id": "refugee_delete_response",
        "type": "function",
        "z": "tab_refugees",
        "name": "Format Delete",
        "func": "msg.statusCode = 204;\nmsg.payload = \"\";\nreturn msg;",
        "outputs": 1,
        "x": 780,
        "y": 440,
        "wires": [
            [
                "refugee_http_response"
            ]
        ]
    },
    {
        "id": "refugee_http_response",
        "type": "http response",
        "z": "tab_refugees",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1000,
        "y": 260,
        "wires": []
    },
    {
        "id": "family_get_all",
        "type": "http in",
        "z": "tab_families",
        "name": "GET /api/families",
        "url": "/api/families",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 80,
        "wires": [
            [
                "family_get_all_query"
            ]
        ]
    },
    {
        "id": "family_get_all_query",
        "type": "postgresql",
        "z": "tab_families",
        "name": "Query All Families",
        "query": "SELECT * FROM families ORDER BY id",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 360,
        "y": 80,
        "wires": [
            [
                "family_response"
            ]
        ]
    },
    {
        "id": "family_get_by_id",
        "type": "http in",
        "z": "tab_families",
        "name": "GET /api/families/:id",
        "url": "/api/families/:id",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 140,
        "wires": [
            [
                "family_get_by_id_prepare"
            ]
        ]
    },
    {
        "id": "family_get_by_id_prepare",
        "type": "function",
        "z": "tab_families",
        "name": "Prepare Query",
        "func": "msg.queryParameters = [parseInt(msg.req.params.id)];\nmsg.payload = \"SELECT * FROM families WHERE id = $1\";\nreturn msg;",
        "outputs": 1,
        "x": 370,
        "y": 140,
        "wires": [
            [
                "family_get_by_id_query"
            ]
        ]
    },
    {
        "id": "family_get_by_id_query",
        "type": "postgresql",
        "z": "tab_families",
        "name": "Query Family",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 570,
        "y": 140,
        "wires": [
            [
                "family_single_response"
            ]
        ]
    },
    {
        "id": "family_get_by_size",
        "type": "http in",
        "z": "tab_families",
        "name": "GET /api/families/size/:size",
        "url": "/api/families/size/:size",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 170,
        "y": 200,
        "wires": [
            [
                "family_get_by_size_prepare"
            ]
        ]
    },
    {
        "id": "family_get_by_size_prepare",
        "type": "function",
        "z": "tab_families",
        "name": "Prepare Query",
        "func": "msg.queryParameters = [parseInt(msg.req.params.size)];\nmsg.payload = \"SELECT * FROM families WHERE family_size = $1 ORDER BY id\";\nreturn msg;",
        "outputs": 1,
        "x": 410,
        "y": 200,
        "wires": [
            [
                "family_get_by_size_query"
            ]
        ]
    },
    {
        "id": "family_get_by_size_query",
        "type": "postgresql",
        "z": "tab_families",
        "name": "Query",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 610,
        "y": 200,
        "wires": [
            [
                "family_response"
            ]
        ]
    },
    {
        "id": "family_post",
        "type": "http in",
        "z": "tab_families",
        "name": "POST /api/families",
        "url": "/api/families",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 260,
        "wires": [
            [
                "family_post_prepare"
            ]
        ]
    },
    {
        "id": "family_post_prepare",
        "type": "function",
        "z": "tab_families",
        "name": "Prepare Insert",
        "func": "const data = msg.payload;\nmsg.queryParameters = [\n    data.family_name, data.family_size, data.head_of_family_id, data.notes\n];\nmsg.payload = `INSERT INTO families (family_name, family_size, head_of_family_id, notes, created_at, updated_at) VALUES ($1, $2, $3, $4, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) RETURNING *`;\nreturn msg;",
        "outputs": 1,
        "x": 370,
        "y": 260,
        "wires": [
            [
                "family_post_query"
            ]
        ]
    },
    {
        "id": "family_post_query",
        "type": "postgresql",
        "z": "tab_families",
        "name": "Insert Family",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 560,
        "y": 260,
        "wires": [
            [
                "family_created_response"
            ]
        ]
    },
    {
        "id": "family_put",
        "type": "http in",
        "z": "tab_families",
        "name": "PUT /api/families/:id",
        "url": "/api/families/:id",
        "method": "put",
        "upload": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 320,
        "wires": [
            [
                "family_put_prepare"
            ]
        ]
    },
    {
        "id": "family_put_prepare",
        "type": "function",
        "z": "tab_families",
        "name": "Prepare Update",
        "func": "const data = msg.payload;\nconst id = parseInt(msg.req.params.id);\nmsg.queryParameters = [\n    data.family_name, data.family_size, data.head_of_family_id, data.notes, id\n];\nmsg.payload = `UPDATE families SET family_name=$1, family_size=$2, head_of_family_id=$3, notes=$4, updated_at=CURRENT_TIMESTAMP WHERE id=$5 RETURNING *`;\nreturn msg;",
        "outputs": 1,
        "x": 370,
        "y": 320,
        "wires": [
            [
                "family_put_query"
            ]
        ]
    },
    {
        "id": "family_put_query",
        "type": "postgresql",
        "z": "tab_families",
        "name": "Update Family",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 570,
        "y": 320,
        "wires": [
            [
                "family_single_response"
            ]
        ]
    },
    {
        "id": "family_delete",
        "type": "http in",
        "z": "tab_families",
        "name": "DELETE /api/families/:id",
        "url": "/api/families/:id",
        "method": "delete",
        "upload": false,
        "swaggerDoc": "",
        "x": 160,
        "y": 380,
        "wires": [
            [
                "family_delete_prepare"
            ]
        ]
    },
    {
        "id": "family_delete_prepare",
        "type": "function",
        "z": "tab_families",
        "name": "Prepare Delete",
        "func": "msg.queryParameters = [parseInt(msg.req.params.id)];\nmsg.payload = \"DELETE FROM families WHERE id = $1\";\nreturn msg;",
        "outputs": 1,
        "x": 380,
        "y": 380,
        "wires": [
            [
                "family_delete_query"
            ]
        ]
    },
    {
        "id": "family_delete_query",
        "type": "postgresql",
        "z": "tab_families",
        "name": "Delete Family",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 570,
        "y": 380,
        "wires": [
            [
                "family_delete_response"
            ]
        ]
    },
    {
        "id": "family_response",
        "type": "function",
        "z": "tab_families",
        "name": "Format Response",
        "func": "msg.statusCode = 200;\nmsg.payload = msg.payload || [];\nreturn msg;",
        "outputs": 1,
        "x": 780,
        "y": 80,
        "wires": [
            [
                "family_http_response"
            ]
        ]
    },
    {
        "id": "family_single_response",
        "type": "function",
        "z": "tab_families",
        "name": "Format Single",
        "func": "if (msg.payload && msg.payload.length > 0) {\n    msg.statusCode = 200;\n    msg.payload = msg.payload[0];\n} else {\n    msg.statusCode = 404;\n    msg.payload = { error: \"Family not found\" };\n}\nreturn msg;",
        "outputs": 1,
        "x": 770,
        "y": 140,
        "wires": [
            [
                "family_http_response"
            ]
        ]
    },
    {
        "id": "family_created_response",
        "type": "function",
        "z": "tab_families",
        "name": "Format Created",
        "func": "msg.statusCode = 201;\nmsg.payload = msg.payload[0];\nreturn msg;",
        "outputs": 1,
        "x": 780,
        "y": 260,
        "wires": [
            [
                "family_http_response"
            ]
        ]
    },
    {
        "id": "family_delete_response",
        "type": "function",
        "z": "tab_families",
        "name": "Format Delete",
        "func": "msg.statusCode = 204;\nmsg.payload = \"\";\nreturn msg;",
        "outputs": 1,
        "x": 770,
        "y": 380,
        "wires": [
            [
                "family_http_response"
            ]
        ]
    },
    {
        "id": "family_http_response",
        "type": "http response",
        "z": "tab_families",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 990,
        "y": 220,
        "wires": []
    },
    {
        "id": "assignment_get_all",
        "type": "http in",
        "z": "tab_assignments",
        "name": "GET /api/assignments",
        "url": "/api/assignments",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 80,
        "wires": [
            [
                "assignment_get_all_query"
            ]
        ]
    },
    {
        "id": "assignment_get_all_query",
        "type": "postgresql",
        "z": "tab_assignments",
        "name": "Query All Assignments",
        "query": "SELECT * FROM assignments ORDER BY id",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 380,
        "y": 80,
        "wires": [
            [
                "assignment_response"
            ]
        ]
    },
    {
        "id": "assignment_get_by_id",
        "type": "http in",
        "z": "tab_assignments",
        "name": "GET /api/assignments/:id",
        "url": "/api/assignments/:id",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 160,
        "y": 140,
        "wires": [
            [
                "assignment_get_by_id_prepare"
            ]
        ]
    },
    {
        "id": "assignment_get_by_id_prepare",
        "type": "function",
        "z": "tab_assignments",
        "name": "Prepare Query",
        "func": "msg.queryParameters = [parseInt(msg.req.params.id)];\nmsg.payload = \"SELECT * FROM assignments WHERE id = $1\";\nreturn msg;",
        "outputs": 1,
        "x": 390,
        "y": 140,
        "wires": [
            [
                "assignment_get_by_id_query"
            ]
        ]
    },
    {
        "id": "assignment_get_by_id_query",
        "type": "postgresql",
        "z": "tab_assignments",
        "name": "Query Assignment",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 600,
        "y": 140,
        "wires": [
            [
                "assignment_single_response"
            ]
        ]
    },
    {
        "id": "assignment_get_by_refugee",
        "type": "http in",
        "z": "tab_assignments",
        "name": "GET /api/assignments/refugee/:refugeeId",
        "url": "/api/assignments/refugee/:refugeeId",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 200,
        "y": 200,
        "wires": [
            [
                "assignment_get_by_refugee_prepare"
            ]
        ]
    },
    {
        "id": "assignment_get_by_refugee_prepare",
        "type": "function",
        "z": "tab_assignments",
        "name": "Prepare Query",
        "func": "msg.queryParameters = [parseInt(msg.req.params.refugeeId)];\nmsg.payload = \"SELECT * FROM assignments WHERE refugee_id = $1 ORDER BY id\";\nreturn msg;",
        "outputs": 1,
        "x": 470,
        "y": 200,
        "wires": [
            [
                "assignment_get_by_refugee_query"
            ]
        ]
    },
    {
        "id": "assignment_get_by_refugee_query",
        "type": "postgresql",
        "z": "tab_assignments",
        "name": "Query",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 670,
        "y": 200,
        "wires": [
            [
                "assignment_response"
            ]
        ]
    },
    {
        "id": "assignment_get_by_shelter",
        "type": "http in",
        "z": "tab_assignments",
        "name": "GET /api/assignments/shelter/:shelterId",
        "url": "/api/assignments/shelter/:shelterId",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 200,
        "y": 260,
        "wires": [
            [
                "assignment_get_by_shelter_prepare"
            ]
        ]
    },
    {
        "id": "assignment_get_by_shelter_prepare",
        "type": "function",
        "z": "tab_assignments",
        "name": "Prepare Query",
        "func": "msg.queryParameters = [parseInt(msg.req.params.shelterId)];\nmsg.payload = \"SELECT * FROM assignments WHERE shelter_id = $1 ORDER BY id\";\nreturn msg;",
        "outputs": 1,
        "x": 470,
        "y": 260,
        "wires": [
            [
                "assignment_get_by_shelter_query"
            ]
        ]
    },
    {
        "id": "assignment_get_by_shelter_query",
        "type": "postgresql",
        "z": "tab_assignments",
        "name": "Query",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 670,
        "y": 260,
        "wires": [
            [
                "assignment_response"
            ]
        ]
    },
    {
        "id": "assignment_get_by_status",
        "type": "http in",
        "z": "tab_assignments",
        "name": "GET /api/assignments/status/:status",
        "url": "/api/assignments/status/:status",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 190,
        "y": 320,
        "wires": [
            [
                "assignment_get_by_status_prepare"
            ]
        ]
    },
    {
        "id": "assignment_get_by_status_prepare",
        "type": "function",
        "z": "tab_assignments",
        "name": "Prepare Query",
        "func": "msg.queryParameters = [msg.req.params.status];\nmsg.payload = \"SELECT * FROM assignments WHERE status = $1 ORDER BY id\";\nreturn msg;",
        "outputs": 1,
        "x": 450,
        "y": 320,
        "wires": [
            [
                "assignment_get_by_status_query"
            ]
        ]
    },
    {
        "id": "assignment_get_by_status_query",
        "type": "postgresql",
        "z": "tab_assignments",
        "name": "Query",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 670,
        "y": 320,
        "wires": [
            [
                "assignment_response"
            ]
        ]
    },
    {
        "id": "assignment_post",
        "type": "http in",
        "z": "tab_assignments",
        "name": "POST /api/assignments",
        "url": "/api/assignments",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 380,
        "wires": [
            [
                "assignment_post_prepare"
            ]
        ]
    },
    {
        "id": "assignment_post_prepare",
        "type": "function",
        "z": "tab_assignments",
        "name": "Prepare Insert",
        "func": "const data = msg.payload;\nmsg.queryParameters = [\n    data.refugee_id, data.shelter_id, data.assignment_date,\n    data.status || 'PENDING', data.priority_score, data.notes\n];\nmsg.payload = `INSERT INTO assignments (refugee_id, shelter_id, assignment_date, status, priority_score, notes, created_at, updated_at) VALUES ($1, $2, $3, $4, $5, $6, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) RETURNING *`;\nreturn msg;",
        "outputs": 1,
        "x": 380,
        "y": 380,
        "wires": [
            [
                "assignment_post_query"
            ]
        ]
    },
    {
        "id": "assignment_post_query",
        "type": "postgresql",
        "z": "tab_assignments",
        "name": "Insert Assignment",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 590,
        "y": 380,
        "wires": [
            [
                "assignment_created_response"
            ]
        ]
    },
    {
        "id": "assignment_put",
        "type": "http in",
        "z": "tab_assignments",
        "name": "PUT /api/assignments/:id",
        "url": "/api/assignments/:id",
        "method": "put",
        "upload": false,
        "swaggerDoc": "",
        "x": 160,
        "y": 440,
        "wires": [
            [
                "assignment_put_prepare"
            ]
        ]
    },
    {
        "id": "assignment_put_prepare",
        "type": "function",
        "z": "tab_assignments",
        "name": "Prepare Update",
        "func": "const data = msg.payload;\nconst id = parseInt(msg.req.params.id);\nmsg.queryParameters = [\n    data.refugee_id, data.shelter_id, data.assignment_date,\n    data.status, data.priority_score, data.notes, id\n];\nmsg.payload = `UPDATE assignments SET refugee_id=$1, shelter_id=$2, assignment_date=$3, status=$4, priority_score=$5, notes=$6, updated_at=CURRENT_TIMESTAMP WHERE id=$7 RETURNING *`;\nreturn msg;",
        "outputs": 1,
        "x": 380,
        "y": 440,
        "wires": [
            [
                "assignment_put_query"
            ]
        ]
    },
    {
        "id": "assignment_put_query",
        "type": "postgresql",
        "z": "tab_assignments",
        "name": "Update Assignment",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 600,
        "y": 440,
        "wires": [
            [
                "assignment_single_response"
            ]
        ]
    },
    {
        "id": "assignment_delete",
        "type": "http in",
        "z": "tab_assignments",
        "name": "DELETE /api/assignments/:id",
        "url": "/api/assignments/:id",
        "method": "delete",
        "upload": false,
        "swaggerDoc": "",
        "x": 170,
        "y": 500,
        "wires": [
            [
                "assignment_delete_prepare"
            ]
        ]
    },
    {
        "id": "assignment_delete_prepare",
        "type": "function",
        "z": "tab_assignments",
        "name": "Prepare Delete",
        "func": "msg.queryParameters = [parseInt(msg.req.params.id)];\nmsg.payload = \"DELETE FROM assignments WHERE id = $1\";\nreturn msg;",
        "outputs": 1,
        "x": 390,
        "y": 500,
        "wires": [
            [
                "assignment_delete_query"
            ]
        ]
    },
    {
        "id": "assignment_delete_query",
        "type": "postgresql",
        "z": "tab_assignments",
        "name": "Delete Assignment",
        "query": "",
        "postgreSQLConfig": "301245f94e1239d9",
        "split": false,
        "rowsPerMsg": "",
        "outputs": 1,
        "x": 600,
        "y": 500,
        "wires": [
            [
                "assignment_delete_response"
            ]
        ]
    },
    {
        "id": "assignment_response",
        "type": "function",
        "z": "tab_assignments",
        "name": "Format Response",
        "func": "msg.statusCode = 200;\nmsg.payload = msg.payload || [];\nreturn msg;",
        "outputs": 1,
        "x": 810,
        "y": 80,
        "wires": [
            [
                "assignment_http_response"
            ]
        ]
    },
    {
        "id": "assignment_single_response",
        "type": "function",
        "z": "tab_assignments",
        "name": "Format Single",
        "func": "if (msg.payload && msg.payload.length > 0) {\n    msg.statusCode = 200;\n    msg.payload = msg.payload[0];\n} else {\n    msg.statusCode = 404;\n    msg.payload = { error: \"Assignment not found\" };\n}\nreturn msg;",
        "outputs": 1,
        "x": 800,
        "y": 140,
        "wires": [
            [
                "assignment_http_response"
            ]
        ]
    },
    {
        "id": "assignment_created_response",
        "type": "function",
        "z": "tab_assignments",
        "name": "Format Created",
        "func": "msg.statusCode = 201;\nmsg.payload = msg.payload[0];\nreturn msg;",
        "outputs": 1,
        "x": 810,
        "y": 380,
        "wires": [
            [
                "assignment_http_response"
            ]
        ]
    },
    {
        "id": "assignment_delete_response",
        "type": "function",
        "z": "tab_assignments",
        "name": "Format Delete",
        "func": "msg.statusCode = 204;\nmsg.payload = \"\";\nreturn msg;",
        "outputs": 1,
        "x": 800,
        "y": 500,
        "wires": [
            [
                "assignment_http_response"
            ]
        ]
    },
    {
        "id": "assignment_http_response",
        "type": "http response",
        "z": "tab_assignments",
        "name": "HTTP Response",
        "statusCode": "",
        "headers": {},
        "x": 1020,
        "y": 280,
        "wires": []
    }
]